<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
  <title>রমাদান ক্যালেন্ডার ১৪৪৭ · ইসলামিক কালেকশন</title>
  <!-- Bootstrap 5 + Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <!-- Google Fonts: Amiri (calligraphic) & Noto Serif Bengali (classic) -->
  <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Noto+Serif+Bengali:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- PWA manifest -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#1a3c34">

  <style>
    /* Islamic color palette & pattern */
    :root {
      --bg-body: #f9f3e7;        /* cream background */
      --bg-card: #ffffffd9;       /* white with slight transparency */
      --text-primary: #1a3c34;     /* deep green */
      --text-secondary: #5f4c3b;   /* warm brown */
      --border-light: #d4b68a;     /* goldish tan */
      --table-header-bg: #e9dcca;   /* light cream */
      --table-row-hover: #f5efe3;
      --highlight-bg: #d1b48c;      /* gold tone */
      --highlight-text: #0a2f1f;    /* dark green */
      --accent: #b38b5b;            /* medium gold */
      --accent-soft: #c9a13b;       /* brighter gold */
      --countdown-bg: linear-gradient(145deg, #1a3c34, #2d5a4a);
      --countdown-text: #f5e7c8;
      --clock-color: #1a3c34;
      --pattern-overlay: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" opacity="0.1"><path d="M20 20 L30 20 L25 30 Z" fill="%23b38b5b"/><path d="M70 70 L80 70 L75 80 Z" fill="%23b38b5b"/><path d="M40 40 L50 40 L45 50 Z" fill="%23b38b5b"/><path d="M10 80 L20 80 L15 90 Z" fill="%23b38b5b"/><path d="M80 20 L90 20 L85 30 Z" fill="%23b38b5b"/></svg>');
    }

    /* Dark mode via prefers-color-scheme (automatically adapts) */
    @media (prefers-color-scheme: dark) {
      :root {
        --bg-body: #0f2a21;
        --bg-card: #1f3e34cc;
        --text-primary: #f5e7c8;
        --text-secondary: #d4b68a;
        --border-light: #7a5f4b;
        --table-header-bg: #2d4a3e;
        --table-row-hover: #2b453a;
        --highlight-bg: #5f4c3b;
        --highlight-text: #f5e7c8;
        --accent: #c9a13b;
        --accent-soft: #b38b5b;
        --countdown-bg: linear-gradient(145deg, #2d5a4a, #1a3c34);
        --countdown-text: #f5e7c8;
        --clock-color: #f5e7c8;
      }
    }

    body {
      background-color: var(--bg-body);
      background-image: var(--pattern-overlay);
      color: var(--text-primary);
      font-family: 'Noto Serif Bengali', 'Amiri', serif;
      transition: background-color 0.2s, color 0.2s;
      min-height: 100vh;
      display: flex;
      align-items: center;
      padding: 0.5rem;
    }

    .amiri-font {
      font-family: 'Amiri', serif;
    }

    .dashboard-card {
      background-color: var(--bg-card);
      backdrop-filter: blur(2px);
      border: 2px solid var(--border-light);
      border-radius: 2rem 2rem 1.5rem 1.5rem;
      box-shadow: 0 30px 50px -20px rgba(0, 0, 0, 0.4);
      overflow: hidden;
      position: relative;
      width: 100%;
    }

    .dashboard-card::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 8px;
      background: linear-gradient(90deg, var(--accent), var(--accent-soft), var(--accent));
      opacity: 0.6;
    }

    .header-islamic {
      background: linear-gradient(135deg, #1a3c34, #2d5a4a);
      color: #f5e7c8;
      padding: 1.2rem 1rem 0.8rem 1rem;
      border-bottom: 4px solid var(--accent);
      position: relative;
    }

    .header-islamic::after {
      content: "ﷺ";
      font-family: 'Amiri', serif;
      font-size: 2rem;
      position: absolute;
      bottom: -10px;
      right: 20px;
      color: var(--accent-soft);
      opacity: 0.5;
      transform: rotate(10deg);
    }

    .live-clock {
      background: #0a2f1f;
      color: #f5e7c8;
      padding: 0.4rem 1.2rem;
      border-radius: 40px;
      font-family: 'Amiri', serif;
      font-weight: 700;
      font-size: 1.2rem;
      border: 2px solid var(--accent);
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
      white-space: nowrap;
    }

    .current-date {
      background: #f5e7c8;
      color: #1a3c34;
      padding: 0.3rem 1.2rem;
      border-radius: 40px;
      font-weight: 600;
      border: 1px solid var(--accent);
      white-space: nowrap;
      font-size: 0.95rem;
    }

    .countdown-hero {
      background: var(--countdown-bg);
      color: var(--countdown-text);
      border-radius: 2.5rem;
      padding: 1.5rem 1rem;
      text-align: center;
      border: 2px solid var(--accent);
      box-shadow: 0 15px 25px -8px #1a3c3480;
    }

    .next-event-timer {
      font-size: 3rem;
      font-weight: 800;
      font-family: 'Amiri', serif;
      line-height: 1.2;
      text-shadow: 2px 2px 4px #0a2f1f;
      word-break: break-word;
    }

    .event-badge {
      background: rgba(255,255,255,0.2);
      backdrop-filter: blur(4px);
      padding: 0.4rem 1.2rem;
      border-radius: 40px;
      font-weight: 600;
      border: 1px solid var(--accent);
      color: var(--countdown-text);
      font-size: 0.9rem;
      white-space: nowrap;
    }

    .table-calendar {
      --bs-table-bg: transparent;
      --bs-table-color: var(--text-primary);
      border-color: var(--border-light);
      margin-bottom: 0;
    }

    .table-calendar th {
      background-color: var(--table-header-bg);
      font-family: 'Amiri', serif;
      font-size: 0.9rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      border-bottom: 2px solid var(--accent);
      white-space: nowrap;
    }

    .table-calendar td {
      padding: 0.7rem 0.3rem;
      border-color: var(--border-light);
      font-family: 'Noto Serif Bengali', serif;
      font-size: 0.9rem;
      white-space: nowrap;
    }

    .table-calendar tbody tr:hover {
      background-color: var(--table-row-hover);
    }

    .highlight-row {
      background-color: var(--highlight-bg) !important;
      color: var(--highlight-text);
      font-weight: 700;
      border-left: 5px solid var(--accent);
    }

    .iftar-time {
      color: var(--accent);
      font-weight: 800;
    }

    .form-select-islamic {
      background-color: var(--bg-card);
      color: var(--text-primary);
      border: 2px solid var(--border-light);
      border-radius: 60px;
      padding: 0.7rem 2.5rem 0.7rem 1.5rem;
      font-weight: 500;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='18' fill='%23b38b5b' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 1.2rem center;
      font-family: 'Noto Serif Bengali', serif;
      font-size: 1rem;
      width: 100%;
    }

    .info-chip {
      background: var(--accent-soft);
      color: #0a2f1f;
      border-radius: 60px;
      padding: 0.5rem 1.2rem;
      font-weight: 600;
      border: 2px solid var(--border-light);
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      font-size: 0.9rem;
      white-space: nowrap;
    }

    .footer-note {
      font-family: 'Amiri', serif;
      font-size: 0.8rem;
    }

    @media (max-width: 480px) {
      body { padding: 0.25rem; }
      .dashboard-card { border-radius: 1.5rem 1.5rem 1rem 1rem; }
      .header-islamic { padding: 1rem 0.8rem 0.6rem 0.8rem; }
      .header-islamic h1 { font-size: 1.3rem; }
      .header-islamic p { font-size: 0.8rem; }
      .live-clock { font-size: 1rem; padding: 0.3rem 0.8rem; }
      .current-date { font-size: 0.8rem; padding: 0.2rem 0.8rem; }
      .countdown-hero { padding: 1.2rem 0.8rem; border-radius: 2rem; }
      .next-event-timer { font-size: 2.2rem; }
      .event-badge { font-size: 0.75rem; padding: 0.3rem 0.8rem; }
      .info-chip { font-size: 0.8rem; padding: 0.4rem 1rem; }
      .form-select-islamic { font-size: 0.9rem; padding: 0.6rem 2rem 0.6rem 1rem; }
      .table-calendar th { font-size: 0.75rem; }
      .table-calendar td { font-size: 0.8rem; padding: 0.5rem 0.2rem; }
    }

    @media (max-width: 768px) and (orientation: landscape) {
      .header-islamic { padding: 0.8rem 1rem; }
      .countdown-hero { padding: 1rem; }
    }
  </style>
</head>
<body>
  <div class="container-fluid py-2 px-1 px-sm-3">
    <div class="dashboard-card">

      <!-- Header with Islamic flair -->
      <div class="header-islamic d-flex flex-wrap align-items-center justify-content-between gap-2">
        <div class="d-flex align-items-center gap-2">
          <i class="bi bi-moon-stars-fill fs-1" style="color: #f5e7c8;"></i>
          <div>
            <h1 class="h4 mb-0 fw-bold" style="font-family: 'Amiri', serif;">رمضان ١٤٤٧</h1>
            <p class="mb-0 opacity-75 small" style="font-family: 'Amiri', serif;">রমাদান ক্যালেন্ডার ২০২৬</p>
            <p class="small mt-1 mb-0 opacity-50 fw-light">১৯ ফেব্রু – ২০ মার্চ · ৮ বিভাগ</p>
          </div>
        </div>
        <div class="d-flex align-items-center gap-2 flex-wrap">
          <div class="live-clock" id="liveClock">
            <i class="bi bi-clock"></i>
            <span id="clockDisplay" class="amiri-font">--:--:-- --</span>
          </div>
          <div class="current-date" id="currentDateDisplay">
            <i class="bi bi-calendar3 me-1"></i>
            <span id="dateDisplay">-- ------ ২০২৬</span>
          </div>
        </div>
      </div>

      <!-- Main content -->
      <div class="p-3 p-md-4 p-xl-5">
        <!-- Division selector & today's badge -->
        <div class="row g-3 align-items-center mb-4">
          <div class="col-12 col-md-5">
            <label class="fw-semibold mb-2 small text-secondary" style="font-family: 'Amiri', serif;">বিভাগ নির্বাচন</label>
            <select id="division" class="form-select-islamic"></select>
          </div>
          <div class="col-12 col-md-7 d-flex flex-wrap gap-2 justify-content-md-end">
            <span id="divisionInfo" class="info-chip"><i class="bi bi-geo-alt-fill me-1"></i>ঢাকা বিভাগ</span>
            <span id="todayRoja" class="info-chip" style="background: var(--accent); color: #0a2f1f;"><i class="bi bi-star-fill me-1"></i>আজ ১ম রোজা</span>
          </div>
        </div>

        <!-- Countdown hero -->
        <div class="countdown-hero mb-4" id="countdownHero">
          <div class="next-event-label small" id="nextEventLabel" style="font-family: 'Amiri', serif;">পরবর্তী সময়সীমা</div>
          <div class="next-event-timer" id="nextEventTimer">--:--:--</div>
          <div class="next-event-sub small" id="nextEventSub" style="font-family: 'Amiri', serif;">সাহরী শেষ হতে</div>
          <div class="mt-3 d-flex justify-content-center gap-2 flex-wrap">
            <span class="event-badge" id="sehriBadge">সাহরী শেষ ৫:১২</span>
            <span class="event-badge" id="fajrBadge">ফজর শুরু ৫:১৫</span>
            <span class="event-badge" id="iftarBadge">ইফতার ৫:৫৮</span>
          </div>
        </div>

        <!-- Calendar table -->
        <div class="table-responsive rounded-4 border" style="border-color: var(--border-light) !important; border-width: 2px !important;">
          <table class="table table-calendar align-middle text-center mb-0">
            <thead>
              <tr>
                <th>রোজা</th>
                <th>তারিখ</th>
                <th>সাহরীর শেষ</th>
                <th>ফজর শুরু</th>
                <th>ইফতার</th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>

        <!-- Footer note -->
        <div class="mt-4 small text-secondary text-center footer-note">
          <i class="bi bi-check-circle-fill me-1" style="color: var(--accent);"></i>
          ইসলামিক ফাউন্ডেশন, বাংলাদেশ ও জেলা পোর্টাল অনুসারে নির্ভুল সময়সূচি · 
          <span style="font-family: 'Amiri', serif;">رمضان كريم</span>
        </div>

        <!-- Credit line -->
        <div class="mt-3 small text-center text-secondary opacity-75" style="font-family: 'Amiri', serif;">
          <i class="bi bi-c-circle me-1"></i> ২০২৬ · Made with <i class="bi bi-heart-fill" style="color: #e25555;"></i> by Rafis · All rights reserved.
        </div>
      </div>
    </div>
  </div>

  <script>
    // ---------- ৩০ দিনের তারিখ ----------
    const dates = [
      "19 Feb", "20 Feb", "21 Feb", "22 Feb", "23 Feb", "24 Feb", "25 Feb", "26 Feb", "27 Feb", "28 Feb",
      "01 Mar", "02 Mar", "03 Mar", "04 Mar", "05 Mar", "06 Mar", "07 Mar", "08 Mar", "09 Mar", "10 Mar",
      "11 Mar", "12 Mar", "13 Mar", "14 Mar", "15 Mar", "16 Mar", "17 Mar", "18 Mar", "19 Mar", "20 Mar"
    ];

    const divisionDetails = {
      "dhaka": "ঢাকা বিভাগ",
      "chattogram": "চট্টগ্রাম বিভাগ",
      "sylhet": "সিলেট বিভাগ",
      "barishal": "বরিশাল বিভাগ",
      "khulna": "খুলনা বিভাগ",
      "rajshahi": "রাজশাহী বিভাগ",
      "rangpur": "রংপুর বিভাগ",
      "mymensingh": "ময়মনসিংহ বিভাগ"
    };

    // Times data (same as before, abbreviated for space)
    const dhakaTimes = [["5:12","5:15","5:58"],["5:11","5:14","5:58"],["5:11","5:14","5:59"],["5:10","5:13","5:59"],["5:09","5:12","6:00"],["5:08","5:11","6:00"],["5:08","5:11","6:01"],["5:07","5:10","6:01"],["5:06","5:09","6:02"],["5:05","5:08","6:02"],["5:05","5:08","6:03"],["5:04","5:07","6:03"],["5:03","5:06","6:04"],["5:02","5:05","6:04"],["5:01","5:04","6:05"],["5:00","5:03","6:05"],["4:59","5:02","6:06"],["4:58","5:01","6:06"],["4:57","5:00","6:07"],["4:57","4:59","6:07"],["4:56","4:58","6:07"],["4:55","4:57","6:08"],["4:54","4:57","6:08"],["4:53","4:56","6:09"],["4:52","4:55","6:09"],["4:51","4:54","6:10"],["4:50","4:53","6:10"],["4:49","4:52","6:10"],["4:48","4:50","6:11"],["4:47","4:49","6:11"]];
    const chattogramTimes = [["5:04","5:10","5:55"],["5:03","5:09","5:56"],["5:02","5:08","5:57"],["5:01","5:07","5:57"],["5:01","5:07","5:58"],["5:00","5:06","5:58"],["4:59","5:05","5:59"],["4:58","5:04","5:59"],["4:57","5:03","6:00"],["4:57","5:03","6:00"],["4:56","5:02","6:01"],["4:55","5:01","6:01"],["4:55","5:01","6:02"],["4:54","5:00","6:02"],["4:53","4:59","6:02"],["4:53","4:59","6:03"],["4:52","4:58","6:03"],["4:51","4:57","6:04"],["4:50","4:56","6:04"],["4:49","4:55","6:05"],["4:48","4:54","6:05"],["4:47","4:53","6:06"],["4:46","4:52","6:06"],["4:45","4:51","6:07"],["4:44","4:50","6:07"],["4:43","4:49","6:08"],["4:42","4:48","6:07"],["4:41","4:47","6:07"],["4:40","4:46","6:08"],["4:39","4:45","6:08"]];
    const sylhetTimes = [["5:03","5:09","5:52"],["5:02","5:08","5:53"],["5:01","5:07","5:54"],["5:00","5:06","5:54"],["5:00","5:06","5:55"],["4:59","5:05","5:55"],["4:58","5:04","5:56"],["4:57","5:03","5:56"],["4:56","5:02","5:57"],["4:56","5:02","5:57"],["4:55","5:01","5:58"],["4:54","5:00","5:58"],["4:54","5:00","5:59"],["4:52","4:58","5:59"],["4:51","4:57","5:59"],["4:50","4:56","6:00"],["4:49","4:55","6:00"],["4:48","4:54","6:01"],["4:47","4:53","6:01"],["4:46","4:52","6:02"],["4:45","4:51","6:02"],["4:44","4:50","6:03"],["4:43","4:49","6:03"],["4:42","4:48","6:04"],["4:41","4:47","6:04"],["4:40","4:46","6:05"],["4:39","4:45","6:05"],["4:38","4:44","6:06"],["4:37","4:43","6:07"],["4:36","4:42","6:07"]];
    const barishalTimes = [["5:08","5:14","6:00"],["5:07","5:13","6:01"],["5:06","5:12","6:01"],["5:05","5:11","6:01"],["5:05","5:11","6:02"],["5:04","5:10","6:02"],["5:03","5:09","6:03"],["5:02","5:08","6:03"],["5:01","5:07","6:04"],["5:01","5:07","6:04"],["5:01","5:07","6:05"],["5:00","5:06","6:05"],["5:00","5:06","6:06"],["4:59","5:05","6:06"],["4:58","5:04","6:06"],["4:57","5:03","6:07"],["4:56","5:02","6:07"],["4:55","5:01","6:08"],["4:54","5:00","6:08"],["4:53","4:59","6:09"],["4:52","4:58","6:09"],["4:51","4:57","6:10"],["4:50","4:56","6:10"],["4:49","4:55","6:11"],["4:48","4:54","6:11"],["4:47","4:53","6:12"],["4:46","4:52","6:12"],["4:45","4:51","6:12"],["4:44","4:50","6:13"],["4:43","4:49","6:13"]];
    const khulnaTimes = [["5:10","5:13","5:59"],["5:09","5:12","5:59"],["5:08","5:11","6:00"],["5:07","5:10","6:00"],["5:06","5:09","6:01"],["5:05","5:08","6:01"],["5:05","5:08","6:02"],["5:04","5:07","6:02"],["5:03","5:06","6:03"],["5:02","5:05","6:03"],["5:02","5:05","6:04"],["5:01","5:04","6:04"],["5:00","5:03","6:05"],["4:59","5:02","6:05"],["4:58","5:01","6:06"],["4:57","5:00","6:06"],["4:56","4:59","6:07"],["4:55","4:58","6:07"],["4:54","4:57","6:07"],["4:53","4:56","6:08"],["4:52","4:55","6:08"],["4:51","4:54","6:09"],["4:50","4:53","6:09"],["4:49","4:52","6:10"],["4:48","4:51","6:10"],["4:47","4:50","6:11"],["4:46","4:49","6:11"],["4:45","4:48","6:11"],["4:44","4:47","6:12"],["4:43","4:46","6:12"]];
    const rajshahiTimes = [["5:14","5:17","5:57"],["5:13","5:16","5:57"],["5:12","5:15","5:58"],["5:11","5:14","5:58"],["5:10","5:13","5:59"],["5:09","5:12","5:59"],["5:09","5:12","6:00"],["5:08","5:11","6:00"],["5:07","5:10","6:01"],["5:06","5:09","6:01"],["5:06","5:09","6:02"],["5:05","5:08","6:02"],["5:04","5:07","6:03"],["5:03","5:06","6:03"],["5:02","5:05","6:04"],["5:01","5:04","6:04"],["5:00","5:03","6:05"],["4:59","5:02","6:05"],["4:58","5:01","6:06"],["4:57","5:00","6:06"],["4:56","4:59","6:06"],["4:55","4:58","6:07"],["4:54","4:57","6:07"],["4:53","4:56","6:08"],["4:52","4:55","6:08"],["4:51","4:54","6:09"],["4:50","4:53","6:09"],["4:49","4:52","6:09"],["4:48","4:51","6:10"],["4:47","4:50","6:10"]];
    const rangpurTimes = [["5:16","5:19","5:56"],["5:15","5:18","5:57"],["5:14","5:17","5:57"],["5:13","5:16","5:58"],["5:12","5:15","5:58"],["5:11","5:14","5:59"],["5:11","5:14","5:59"],["5:10","5:13","6:00"],["5:09","5:12","6:00"],["5:08","5:11","6:01"],["5:08","5:11","6:01"],["5:07","5:10","6:02"],["5:06","5:09","6:02"],["5:05","5:08","6:03"],["5:04","5:07","6:03"],["5:03","5:06","6:04"],["5:02","5:05","6:04"],["5:01","5:04","6:05"],["5:00","5:03","6:05"],["4:59","5:02","6:06"],["4:58","5:01","6:06"],["4:57","5:00","6:07"],["4:56","4:59","6:07"],["4:55","4:58","6:08"],["4:54","4:57","6:08"],["4:53","4:56","6:09"],["4:52","4:55","6:09"],["4:51","4:54","6:10"],["4:50","4:53","6:10"],["4:49","4:52","6:11"]];
    const mymensinghTimes = [["5:11","5:14","5:59"],["5:10","5:13","5:59"],["5:10","5:13","6:00"],["5:09","5:12","6:00"],["5:08","5:11","6:01"],["5:07","5:10","6:01"],["5:07","5:10","6:02"],["5:06","5:09","6:02"],["5:05","5:08","6:03"],["5:04","5:07","6:03"],["5:04","5:07","6:04"],["5:03","5:06","6:04"],["5:02","5:05","6:05"],["5:01","5:04","6:05"],["5:00","5:03","6:06"],["4:59","5:02","6:06"],["4:58","5:01","6:07"],["4:57","5:00","6:07"],["4:56","4:59","6:07"],["4:55","4:58","6:08"],["4:54","4:57","6:08"],["4:53","4:56","6:09"],["4:52","4:55","6:09"],["4:51","4:54","6:10"],["4:50","4:53","6:10"],["4:49","4:52","6:11"],["4:48","4:51","6:11"],["4:47","4:50","6:12"],["4:46","4:49","6:12"],["4:45","4:48","6:13"]];

    const divisions = {
      "dhaka": dhakaTimes,
      "chattogram": chattogramTimes,
      "sylhet": sylhetTimes,
      "barishal": barishalTimes,
      "khulna": khulnaTimes,
      "rajshahi": rajshahiTimes,
      "rangpur": rangpurTimes,
      "mymensingh": mymensinghTimes
    };

    // DOM elements
    const divisionSelect = document.getElementById('division');
    const tbody = document.getElementById('tbody');
    const divisionInfo = document.getElementById('divisionInfo');
    const todayRojaEl = document.getElementById('todayRoja');
    const clockDisplay = document.getElementById('clockDisplay');
    const dateDisplay = document.getElementById('dateDisplay');
    const nextEventTimer = document.getElementById('nextEventTimer');
    const nextEventSub = document.getElementById('nextEventSub');
    const sehriBadge = document.getElementById('sehriBadge');
    const fajrBadge = document.getElementById('fajrBadge');
    const iftarBadge = document.getElementById('iftarBadge');

    // Populate divisions
    for (let key in divisions) {
      let option = document.createElement('option');
      option.value = key;
      let name = '';
      if (key === 'dhaka') name = 'ঢাকা';
      else if (key === 'chattogram') name = 'চট্টগ্রাম';
      else if (key === 'sylhet') name = 'সিলেট';
      else if (key === 'barishal') name = 'বরিশাল';
      else if (key === 'khulna') name = 'খুলনা';
      else if (key === 'rajshahi') name = 'রাজশাহী';
      else if (key === 'rangpur') name = 'রংপুর';
      else if (key === 'mymensingh') name = 'ময়মনসিংহ';
      option.textContent = name;
      divisionSelect.appendChild(option);
    }
    divisionSelect.value = 'dhaka';

    // ---------- Improved date handling ----------
    const ramadanStart = new Date(2026, 1, 19); // Feb 19, 2026 (month 1 = February)
    const ramadanEnd = new Date(2026, 2, 20);   // Mar 20, 2026

    function getRamadanDayIndex() {
      let now = new Date();
      // Set time to midnight for comparison
      let today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
      
      if (today < ramadanStart) {
        return -1; // before Ramadan
      } else if (today > ramadanEnd) {
        return -2; // after Ramadan
      } else {
        // inside Ramadan: calculate day index
        let diff = Math.floor((today - ramadanStart) / (1000 * 60 * 60 * 24));
        return diff; // 0 to 29
      }
    }

    // update clock and date
    function updateClockAndDate() {
      let now = new Date();
      let hours = now.getHours();
      let minutes = now.getMinutes().toString().padStart(2, '0');
      let seconds = now.getSeconds().toString().padStart(2, '0');
      let ampm = hours >= 12 ? 'PM' : 'AM';
      hours = hours % 12;
      hours = hours ? hours : 12;
      let hoursStr = hours.toString().padStart(2, '0');
      clockDisplay.innerText = `${hoursStr}:${minutes}:${seconds} ${ampm}`;

      let day = now.getDate();
      let month = now.toLocaleString('bn', { month: 'long' });
      let year = now.getFullYear();
      dateDisplay.innerText = `${day} ${month} ${year}`;
    }

    // main render
    function render() {
      let div = divisionSelect.value;
      divisionInfo.innerHTML = `<i class="bi bi-geo-alt-fill me-1"></i>${divisionDetails[div]}`;
      let times = divisions[div];
      let dayIndex = getRamadanDayIndex();
      
      // Build table
      let html = '';
      times.forEach((t, i) => {
        // Highlight only if we are inside Ramadan and it's today
        let rowClass = (dayIndex >= 0 && i === dayIndex) ? 'highlight-row' : '';
        html += `<tr class="${rowClass}">
          <td>${i+1}</td>
          <td>${dates[i]}</td>
          <td>${t[0]}</td>
          <td>${t[1]}</td>
          <td class="iftar-time fw-bold">${t[2]}</td>
        </tr>`;
      });
      tbody.innerHTML = html;

      // Update "today" badge
      if (dayIndex >= 0) {
        todayRojaEl.innerHTML = `<i class="bi bi-star-fill me-1"></i>আজ ${dayIndex+1}ম রোজা`;
      } else if (dayIndex === -1) {
        todayRojaEl.innerHTML = `<i class="bi bi-clock me-1"></i>রমাদান শুরু হবে ১৯ ফেব্রু`;
      } else {
        todayRojaEl.innerHTML = `<i class="bi bi-check-circle me-1"></i>রমাদান শেষ`;
      }

      // Always show the times of the relevant day in badges:
      // If before Ramadan → show first day's times
      // If after Ramadan → show last day's times
      // If inside → show today's times
      let badgeIndex;
      if (dayIndex >= 0) badgeIndex = dayIndex;
      else if (dayIndex === -1) badgeIndex = 0; // first day
      else badgeIndex = 29; // last day

      let t = times[badgeIndex];
      sehriBadge.innerText = `সাহরী শেষ ${t[0]}`;
      fajrBadge.innerText = `ফজর শুরু ${t[1]}`;
      iftarBadge.innerText = `ইফতার ${t[2]}`;

      updateCountdown(); // refresh countdown
    }

    // Countdown logic (FIXED: Iftar now treated as PM)
    function updateCountdown() {
      let div = divisionSelect.value;
      let times = divisions[div];
      let dayIndex = getRamadanDayIndex();
      let now = new Date();

      // If after Ramadan
      if (dayIndex === -2) {
        nextEventTimer.innerText = 'রমাদান শেষ';
        nextEventSub.innerText = 'আবার আসবে ইনশাআল্লাহ';
        return;
      }

      // Determine which day's times to use for target
      let targetDayIndex;
      if (dayIndex === -1) {
        targetDayIndex = 0; // first day
      } else {
        targetDayIndex = dayIndex;
      }

      let todayTimes = times[targetDayIndex];
      let tomorrowTimes = (targetDayIndex + 1 < 30) ? times[targetDayIndex + 1] : null;

      // Build Date objects for today's events (using the actual date of that Ramadan day)
      // We need to set the date to the corresponding calendar date in 2026.
      let targetDate = new Date(ramadanStart);
      targetDate.setDate(ramadanStart.getDate() + targetDayIndex); // moves to correct day

      let sehri = new Date(targetDate);
      let [sh, sm] = todayTimes[0].split(':').map(Number);
      sehri.setHours(sh, sm, 0);

      let fajr = new Date(targetDate);
      let [fh, fm] = todayTimes[1].split(':').map(Number);
      fajr.setHours(fh, fm, 0);

      // Iftar is in the evening (PM) – add 12 hours to convert to 24h format
      let [ih, im] = todayTimes[2].split(':').map(Number);
      let iftar = new Date(targetDate);
      iftar.setHours(ih + 12, im, 0);

      // Next day Sehri (if exists)
      let nextSehri = null;
      if (tomorrowTimes) {
        let nextDate = new Date(targetDate);
        nextDate.setDate(targetDate.getDate() + 1);
        let [nsh, nsm] = tomorrowTimes[0].split(':').map(Number);
        nextSehri = new Date(nextDate);
        nextSehri.setHours(nsh, nsm, 0);
      }

      // Determine next event
      let targetTime = null;
      let eventName = '';

      // If before Ramadan, we target the first Sehri
      if (dayIndex === -1) {
        targetTime = sehri;
        eventName = 'রমাদান শুরু';
      } else {
        // Inside Ramadan: compare with now
        if (now < sehri) {
          targetTime = sehri;
          eventName = 'সাহরী শেষ';
        } else if (now < fajr) {
          targetTime = fajr;
          eventName = 'ফজর শুরু';
        } else if (now < iftar) {
          targetTime = iftar;
          eventName = 'ইফতার';
        } else if (nextSehri) {
          targetTime = nextSehri;
          eventName = 'আগামীকাল সাহরী শেষ';
        } else {
          // Last day after iftar
          nextEventTimer.innerText = 'রমাদান শেষ';
          nextEventSub.innerText = 'আবার আসবে ইনশাআল্লাহ';
          return;
        }
      }

      let diff = targetTime - now;
      if (diff <= 0) {
        // fallback: recompute? Usually shouldn't happen
        nextEventTimer.innerText = '00:00:00';
        nextEventSub.innerText = eventName;
        return;
      }

      let hrs = Math.floor(diff / 3600000);
      let mins = Math.floor((diff % 3600000) / 60000);
      let secs = Math.floor((diff % 60000) / 1000);

      nextEventTimer.innerText = `${hrs.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
      nextEventSub.innerText = eventName;
    }

    // Set intervals and events
    setInterval(() => {
      updateClockAndDate();
      updateCountdown();
    }, 1000);

    divisionSelect.addEventListener('change', render);

    // Initial render
    render();
    updateClockAndDate();
  </script>
</body>
</html>
